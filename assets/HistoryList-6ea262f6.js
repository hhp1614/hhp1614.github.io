import{j as H,A as h,B as t,L as S,C as U,P as R,N as P,y as b,r as w,h as L,k as Y,D as v,H as x,T as j,n as q,E as G,J,u as s,I as z,K as E,M as O,a as T,G as M}from"./@vue-b0826c04.js";import{g as W,_ as Z,a as Q,r as X}from"./history-603a9ed9.js";import{_ as ee}from"./BtnIcon.vuevuetypescriptsetuptruelang-4d4ac8a4.js";import{_ as te}from"./Icon.vuevuetypescriptsetuptruelang-5f3c4842.js";import{_ as ae}from"./FormSelect.vuevuetypescriptsetuptruelang-25080e49.js";import{_ as le}from"./FormInput.vuevuetypescriptsetuptruelang-d869f523.js";import{t as ne}from"./request-470f9b44.js";const oe={class:"dialog-wrapper"},se={key:0,class:"dialog-title"},ie={class:"dialog-content"},re={class:"dialog-action"},de=H({__name:"Dialog",props:{modelValue:{type:Boolean,default:!1},title:String},emits:["update:modelValue","success"],setup(c,{emit:_}){function o(){_("success"),_("update:modelValue",!1)}return(y,k)=>c.modelValue?(b(),h("div",{key:0,class:"dialog",onClick:k[0]||(k[0]=P(C=>_("update:modelValue",!1),["self"]))},[t("div",oe,[c.title?(b(),h("div",se,S(c.title),1)):U("",!0),t("div",ie,[R(y.$slots,"default")]),t("div",re,[R(y.$slots,"action",{},()=>[t("button",{onClick:o},"确定")])])])])):U("",!0)}}),ce=["tooltip"],ue=["type","placeholder","disabled","value","readonly"],pe=["onClick"],me={class:"date-picker-calendal-header"},fe={class:"date-picker-calendal-header-content"},ve=t("div",{class:"date-picker-calendal-week"},[t("span",null,"日"),t("span",null,"一"),t("span",null,"二"),t("span",null,"三"),t("span",null,"四"),t("span",null,"五"),t("span",null,"六")],-1),ye={class:"date-picker-calendal-body"},_e=["onClick"],ke=H({__name:"DatePicker",props:{type:{type:String,default:"text"},placeholder:String,label:String,readonly:Boolean,disabled:Boolean,clearable:Boolean,modelValue:String},emits:["update:modelValue","clear"],setup(c,{emit:_}){const o=c,y=a=>String(a).padStart(2,"0"),k=()=>Number.isNaN(Date.parse(o.modelValue))?new Date:new Date(o.modelValue),C=w(),u=w(),r=L(()=>{const a=k();return{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate()}}),m=w(k()),V=L(()=>({year:m.value.getFullYear(),month:m.value.getMonth()+1,day:m.value.getDate()})),$=w(!1),N=L(()=>{const a=[],{year:n,month:f}=V.value,e=new Date(n,f,0).getDate();let d=new Date(n,f-1,1).getDay();d=d===0?7:d;const g=new Date(n,f-1,0).getDate(),B=d-1;for(let p=B;p>=0;p--)a.push({day:g-p,data:`${n}-${y(f-1)}-${y(g-p)}`});for(let p=1;p<=e;p++)a.push({day:p,data:`${n}-${y(f)}-${y(p)}`,current:!0});const A=42-e-B;for(let p=1;p<A;p++)a.push({day:p,data:`${n}-${y(f+1)}-${y(p)}`});return a});function i(){var a;$.value=!0,(a=u.value)==null||a.focus()}function l(a){var n;_("update:modelValue",a.data),m.value=new Date(a.data),$.value=!1,(n=u.value)==null||n.blur()}function D(a){m.value=new Date(m.value.setMonth(m.value.getMonth()+a))}function F(a){const{year:n,month:f}=V.value,{year:e,month:d,day:g}=r.value,B=e===n&&d===f&&g===a.day;return{current:a.current,active:o.modelValue&&a.current&&B}}function I(a){const n=a.target;_("update:modelValue",n.value),q(()=>{m.value=k()})}function K(){_("update:modelValue",""),_("clear"),$.value=!1}return Y(()=>{document.addEventListener("click",a=>{var n;(n=C.value)!=null&&n.contains(a.target)||($.value=!1)})}),(a,n)=>{const f=te;return b(),h("div",{ref_key:"datePickerRef",ref:C,class:"form-item date-picker",onClick:i},[t("div",{class:"prefix",tooltip:c.label},[v(f,{name:"date"})],8,ce),t("input",{ref_key:"inputRef",ref:u,type:c.type,placeholder:c.placeholder||c.label,disabled:c.disabled,value:c.modelValue,onInput:n[0]||(n[0]=e=>I(e)),readonly:c.readonly},null,40,ue),c.clearable?(b(),h("span",{key:0,class:"close",onClick:P(K,["stop"])},"×",8,pe)):U("",!0),v(j,{name:"slide-fade"},{default:x(()=>[G(t("div",{class:"date-picker-calendal",onClick:n[3]||(n[3]=P((...e)=>{var d,g;return((d=s(u))==null?void 0:d.focus)&&((g=s(u))==null?void 0:g.focus(...e))},["stop"]))},[t("div",me,[t("span",{class:"date-picker-calendal-header-icon",onClick:n[1]||(n[1]=e=>D(-1))},"‹"),t("span",fe,S(s(V).year)+"年"+S(s(V).month)+"月",1),t("span",{class:"date-picker-calendal-header-icon",onClick:n[2]||(n[2]=e=>D(1))},"›")]),ve,t("div",ye,[(b(!0),h(z,null,E(s(N),(e,d)=>(b(),h("span",{key:d,class:O(F(e)),onClick:P(g=>l(e),["stop"])},S(e.day),11,_e))),128))])],512),[[J,s($)]])]),_:1})],512)}}}),he={class:"history-list"},be={class:"form"},ge={class:"content"},$e=["onClick"],Ce=["onClick"],Ve=["onClick"],De=["onClick"],we={class:"wrap"},Se={width:"80"},Ie=H({__name:"HistoryList",setup(c){const _=[{value:"http"},{value:"https"}],o=T({title:"",scheme:"",host:"",port:"",page:1,size:28,ts:""}),y=[{prop:"title",label:"标题"},{prop:"scheme",label:"协议",width:50},{prop:"host",label:"域名",width:200},{prop:"port",label:"端口",width:50},{prop:"create_ts",label:"创建时间",width:140},{prop:"action",label:"操作",width:170,slot:!0}],k=w([]),C=w(0),u=T({visible:!1,title:"",row:{},data:[]});async function r(i){typeof i=="number"&&(o.page=i);const l=await W(o);k.value=l.data.data,o.page=l.data.current_page,C.value=l.data.total}function m(i,l=!1){window.open(i,l?"_blank":"_self")}function V(i){u.visible=!0,u.row=i,u.data=[{label:"标题",value:i.title},{label:"协议",value:i.scheme},{label:"域名",value:i.host},{label:"端口",value:i.port},{label:"路径",value:i.path},{label:"查询参数",value:i.query},{label:"锚点",value:i.fragment},{label:"创建时间",value:i.create_ts},{label:"链接",value:i.url}]}async function $(i){if(!confirm("确定删除吗?"))return;(await X(i)).status&&ne("删除成功","success")&&r()}function N(){o.title="",o.scheme="",o.host="",o.port="",r()}return r(),(i,l)=>{const D=le,F=ae,I=ke,K=ee,a=Z,n=Q,f=de;return b(),h(z,null,[t("div",he,[t("div",be,[v(D,{modelValue:s(o).title,"onUpdate:modelValue":l[0]||(l[0]=e=>s(o).title=e),class:"full",label:"标题",onKeydown:M(r,["enter"]),onClear:r,clearable:""},null,8,["modelValue","onKeydown"]),v(F,{modelValue:s(o).scheme,"onUpdate:modelValue":l[1]||(l[1]=e=>s(o).scheme=e),label:"协议",list:_,placeholder:"选择协议",onChange:l[2]||(l[2]=e=>r()),onClear:r,clearable:""},null,8,["modelValue"]),v(D,{modelValue:s(o).host,"onUpdate:modelValue":l[3]||(l[3]=e=>s(o).host=e),class:"full",label:"域名",onKeydown:M(r,["enter"]),onClear:r,clearable:""},null,8,["modelValue","onKeydown"]),v(D,{modelValue:s(o).port,"onUpdate:modelValue":l[4]||(l[4]=e=>s(o).port=e),type:"number",label:"端口",onKeydown:M(r,["enter"]),onClear:r,clearable:""},null,8,["modelValue","onKeydown"]),v(I,{modelValue:s(o).ts,"onUpdate:modelValue":l[5]||(l[5]=e=>s(o).ts=e),label:"创建时间",onKeydown:M(r,["enter"]),onClear:r,clearable:""},null,8,["modelValue","onKeydown"]),v(K,{icon:"search",tooltip:"查询",onClick:r}),v(K,{icon:"clear",onClick:N})]),t("div",ge,[v(a,{cols:y,data:s(k)},{action:x(({row:e})=>[t("span",{class:"link",onClick:d=>m(e.url)},"打开",8,$e),t("span",{class:"link",onClick:d=>m(e.url,!0)},"新标签页",8,Ce),t("span",{class:"link",onClick:d=>V(e)},"详情",8,Ve),t("span",{class:"link",onClick:d=>$(e.id)},"删除",8,De)]),_:1},8,["data"]),v(n,{page:s(o).page,size:s(o).size,total:s(C),onChange:r},null,8,["page","size","total"])])]),v(f,{title:"详情",modelValue:s(u).visible,"onUpdate:modelValue":l[8]||(l[8]=e=>s(u).visible=e)},{action:x(()=>[t("button",{onClick:l[6]||(l[6]=e=>m(s(u).row.url))},"当前窗口打开"),t("button",{onClick:l[7]||(l[7]=e=>m(s(u).row.url,!0))},"新标签页打开")]),default:x(()=>[t("table",we,[(b(!0),h(z,null,E(s(u).data,({label:e,value:d})=>(b(),h("tr",null,[t("td",Se,S(e),1),t("td",null,S(d),1)]))),256))])]),_:1},8,["modelValue"])],64)}}});export{Ie as default};
