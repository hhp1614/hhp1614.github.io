import{j as I,a as V,r as k,l as u,x as b,A as s,z as r,N as h,D as f,F as T,v as _,H as N,I as $}from"./@vue-c550c1ff.js";const U="http://localhost/homepage";async function w(c,d={}){return(await fetch(U+c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json()}function H(c){return w("/history/all",c)}function j(c){return w("/history/remove",{id:c})}function q(c,d="info",e=2){const n=document.querySelector(".toast");n&&n.remove();const p=200,i=document.createElement("div");return i.className=`toast ${d}`,i.style.animation=`toast-in ${p}ms`,i.innerText=c,document.body.appendChild(i),setTimeout(()=>{i.style.animation=`toast-out ${p}ms forwards`,setTimeout(()=>i.remove(),p)},e*1e3),!0}const L={class:"history-list"},P={class:"form"},A={class:"content"},E=["onClick"],O=["onClick"],J=["onClick"],G={class:"wrap"},M={width:"80"},R=I({__name:"HistoryList",setup(c){const d=[{value:"http"},{value:"https"}],e=V({title:"",scheme:"",host:"",port:"",page:1,size:28}),n=V({visible:!1,title:"",row:{},data:[]}),p=[{prop:"title",label:"标题"},{prop:"scheme",label:"协议",width:50},{prop:"host",label:"域名",width:200},{prop:"port",label:"端口",width:50},{prop:"create_ts",label:"创建时间",width:140},{prop:"action",label:"操作",width:105,slot:!0}],i=k([]),y=k(0);async function a(l){typeof l=="number"&&(e.page=l);const t=await H(e);i.value=t.data.data,e.page=t.data.current_page,y.value=t.data.total}function g(l){window.open(l,"_blank")}function D(l){n.visible=!0,n.row=l,n.data=[{label:"标题",value:l.title},{label:"协议",value:l.scheme},{label:"域名",value:l.host},{label:"端口",value:l.port},{label:"路径",value:l.path},{label:"查询参数",value:l.query},{label:"锚点",value:l.fragment},{label:"创建时间",value:l.create_ts},{label:"链接",value:l.url}]}async function F(l){if(!confirm("确定删除吗?"))return;(await j(l)).status&&q("删除成功","success")&&a()}function K(){e.title="",e.scheme="",e.host="",e.port="",a()}return a(),(l,t)=>{const v=u("FormInput"),S=u("FormSelect"),C=u("BtnIcon"),x=u("DataTable"),z=u("Paginate"),B=u("Dialog");return _(),b(T,null,[s("div",L,[s("div",P,[r(v,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=o=>e.title=o),class:"full",label:"标题",onKeypress:h(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),r(S,{modelValue:e.scheme,"onUpdate:modelValue":t[1]||(t[1]=o=>e.scheme=o),label:"协议",list:d,placeholder:"选择协议",onChange:t[2]||(t[2]=o=>a()),onClear:a,clearable:""},null,8,["modelValue"]),r(v,{modelValue:e.host,"onUpdate:modelValue":t[3]||(t[3]=o=>e.host=o),class:"full",label:"域名",onKeypress:h(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),r(v,{modelValue:e.port,"onUpdate:modelValue":t[4]||(t[4]=o=>e.port=o),label:"端口",onKeypress:h(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),r(C,{icon:"search",tooltip:"查询",onClick:a}),r(C,{icon:"clear",onClick:K})]),s("div",A,[r(x,{cols:p,data:i.value},{action:f(({row:o})=>[s("span",{class:"link",onClick:m=>g(o.url)},"打开",8,E),s("span",{class:"link",onClick:m=>D(o)},"详情",8,O),s("span",{class:"link",onClick:m=>F(o.id)},"删除",8,J)]),_:1},8,["data"]),r(z,{page:e.page,size:e.size,total:y.value,onChange:a},null,8,["page","size","total"])])]),r(B,{title:"详情",modelValue:n.visible,"onUpdate:modelValue":t[6]||(t[6]=o=>n.visible=o)},{action:f(()=>[s("button",{onClick:t[5]||(t[5]=o=>g(n.row.url))},"打开链接")]),default:f(()=>[s("table",G,[(_(!0),b(T,null,N(n.data,({label:o,value:m})=>(_(),b("tr",null,[s("td",M,$(o),1),s("td",null,$(m),1)]))),256))])]),_:1},8,["modelValue"])],64)}}});export{R as default};
