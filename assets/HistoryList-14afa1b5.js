import{j as I,a as V,r as k,l as c,x as h,A as s,z as i,O as b,D as f,F as D,v as y,H as P,I as K}from"./@vue-494dff21.js";const H="http://localhost/homepage";async function T(u,p={}){return(await fetch(H+u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).json()}function N(u){return T("/history/all",u)}function j(u){return T("/history/remove",{id:u})}function q(u,p="info",e=2){const n=document.querySelector(".toast");n&&n.remove();const d=200,r=document.createElement("div");return r.className=`toast ${p}`,r.style.animation=`toast-in ${d}ms`,r.innerText=u,document.body.appendChild(r),setTimeout(()=>{r.style.animation=`toast-out ${d}ms forwards`,setTimeout(()=>r.remove(),d)},e*1e3),!0}const L={class:"history-list"},O={class:"form"},A={class:"content"},E=["onClick"],J=["onClick"],G=["onClick"],M={class:"wrap"},Q={width:"80"},W=I({__name:"HistoryList",setup(u){const p=[{value:"http"},{value:"https"}],e=V({title:"",scheme:"",host:"",port:"",page:1,size:28,ts:""}),n=V({visible:!1,title:"",row:{},data:[]}),d=[{prop:"title",label:"标题"},{prop:"scheme",label:"协议",width:50},{prop:"host",label:"域名",width:200},{prop:"port",label:"端口",width:50},{prop:"create_ts",label:"创建时间",width:140},{prop:"action",label:"操作",width:105,slot:!0}],r=k([]),_=k(0);async function a(o){typeof o=="number"&&(e.page=o);const t=await N(e);r.value=t.data.data,e.page=t.data.current_page,_.value=t.data.total}function C(o){window.open(o,"_blank")}function $(o){n.visible=!0,n.row=o,n.data=[{label:"标题",value:o.title},{label:"协议",value:o.scheme},{label:"域名",value:o.host},{label:"端口",value:o.port},{label:"路径",value:o.path},{label:"查询参数",value:o.query},{label:"锚点",value:o.fragment},{label:"创建时间",value:o.create_ts},{label:"链接",value:o.url}]}async function w(o){if(!confirm("确定删除吗?"))return;(await j(o)).status&&q("删除成功","success")&&a()}function F(){e.title="",e.scheme="",e.host="",e.port="",a()}return a(),(o,t)=>{const v=c("FormInput"),S=c("FormSelect"),U=c("DatePicker"),g=c("BtnIcon"),x=c("DataTable"),z=c("Paginate"),B=c("Dialog");return y(),h(D,null,[s("div",L,[s("div",O,[i(v,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=l=>e.title=l),class:"full",label:"标题",onKeypress:b(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),i(S,{modelValue:e.scheme,"onUpdate:modelValue":t[1]||(t[1]=l=>e.scheme=l),label:"协议",list:p,placeholder:"选择协议",onChange:t[2]||(t[2]=l=>a()),onClear:a,clearable:""},null,8,["modelValue"]),i(v,{modelValue:e.host,"onUpdate:modelValue":t[3]||(t[3]=l=>e.host=l),class:"full",label:"域名",onKeypress:b(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),i(v,{modelValue:e.port,"onUpdate:modelValue":t[4]||(t[4]=l=>e.port=l),type:"number",label:"端口",onKeypress:b(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),i(U,{modelValue:e.ts,"onUpdate:modelValue":t[5]||(t[5]=l=>e.ts=l),label:"创建时间",onKeypress:b(a,["enter"]),onClear:a,clearable:""},null,8,["modelValue","onKeypress"]),i(g,{icon:"search",tooltip:"查询",onClick:a}),i(g,{icon:"clear",onClick:F})]),s("div",A,[i(x,{cols:d,data:r.value},{action:f(({row:l})=>[s("span",{class:"link",onClick:m=>C(l.url)},"打开",8,E),s("span",{class:"link",onClick:m=>$(l)},"详情",8,J),s("span",{class:"link",onClick:m=>w(l.id)},"删除",8,G)]),_:1},8,["data"]),i(z,{page:e.page,size:e.size,total:_.value,onChange:a},null,8,["page","size","total"])])]),i(B,{title:"详情",modelValue:n.visible,"onUpdate:modelValue":t[7]||(t[7]=l=>n.visible=l)},{action:f(()=>[s("button",{onClick:t[6]||(t[6]=l=>C(n.row.url))},"打开链接")]),default:f(()=>[s("table",M,[(y(!0),h(D,null,P(n.data,({label:l,value:m})=>(y(),h("tr",null,[s("td",Q,K(l),1),s("td",null,K(m),1)]))),256))])]),_:1},8,["modelValue"])],64)}}});export{W as default};
